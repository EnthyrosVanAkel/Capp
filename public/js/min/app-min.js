var app=angular.module("app",["ngRoute","oitozero.ngSweetAlert"]),modelos=["A","A Izquierda","B","B Izquierda","B2","C","D","D Izquierda","D Penthouse","E","E Penthouse","F","F Penthouse","G"],deptos_url="json/deptos.json",login_url="json/demo.json",post_url="json/deptos.json",navArray=["Inicio de Secion","Intro","Base","Acabados","Adicionales","Arquitectos","Resumen","Enviar"];app.config(function(t){t.startSymbol("<%"),t.endSymbol("%>")}),app.config(function(t){t.when("/",{templateUrl:"templates/login-template.html",controller:"logInCtrl",controllerAs:"log"}).when("/1",{templateUrl:"templates/info-template.html"}).when("/2",{templateUrl:"templates/base-template.html",controller:"baseCtrl",controllerAs:"base"}).when("/3",{templateUrl:"templates/acabados-template.html",controller:"acabadosCtrl",controllerAs:"sectionCtrl"}).when("/4",{templateUrl:"templates/adicionales-template.html",controller:"addCtrl",controllerAs:"sectionCtrl"}).when("/5",{templateUrl:"templates/arq-template.html",controller:"arqCtrl",controllerAs:"billForm"}).when("/6",{templateUrl:"templates/resumen-template.html",controller:"billCtrl",controllerAs:"billForm"}).when("/7",{templateUrl:"templates/send-template.html",controller:"sendCtrl"}).otherwise({redirectTo:function(t,e,a){return location.reload(),"/"}})}),app.run(function(t){0==t.count&&(location.href="#/",t.count=0)}),app.service("navService",function(){this.title="VIDALTA",this.navArray=navArray,this.count=0,this.subCount={},this.subCount.count=0,this.subCount.max=0,this.subCount.active=!1,this.isLogIn=function(t){return 0==this.count&&0==t?!0:0!=this.count&&0!=t?!0:!1},this.prevActive=function(){var t=this.count>1?!0:!1;return t},this.nextActive=function(){var t=this.count>0&&this.count<this.navArray.length-1?!0:!1;return t},this.isActive=function(t){var e=t==this.count?!0:!1;return e},this.next=function(){this.count<=this.navArray.length-1&&(this.subCount.active&&this.subCount.count<this.subCount.max-1?this.subCount.count+=1:(this.count+=1,location.href="#/"+this.count,this.subCount.count=0,this.subCount.max=0,this.subCount.active=!1))},this.prev=function(){this.count>1&&(this.subCount.active&&this.subCount.count>0?this.subCount.count-=1:(this.count-=1,location.href="#/"+this.count,this.subCount.count=0,this.subCount.max=0,this.subCount.active=!1))}}),app.service("billService",function(t){this.userEmail="",this.deptoModel="",this.deptoNumber=0,this.billArray=[],this.aditionalArray=[],this.taxesArray=[],this.taxesActive=!1,this.arqSelect=[],this.baseArray=[],this.acabadosArray=[],this.adicionalesArray=[],this.baseArray.active=!1,this.acabadosArray.active=!1,this.adicionalesArray.active=!1,this.subTotalBill=0,this.subTotalAditional=0,this.iva=0,this.totalBill=0,this.add=function(t){this.billArray.push(t)},this.delate=function(t){var e=this.billArray.indexOf(t);null!=e&&this.billArray.splice(e,1)},this.addAditional=function(t){this.aditionalArray.push(t)},this.delateAditional=function(t){var e=this.aditionalArray.indexOf(t);null!=e&&this.aditionalArray.splice(e,1)},this.addArq=function(t){this.arqSelect.push(t)},this.delateArq=function(t){var e=this.arqSelect.indexOf(t);null!=e&&this.arqSelect.splice(e,1)},this.calcBill=function(){this.calcSubTotal(),this.calcAditional(),this.getTaxes(this.subTotalBill),this.calcTotal()},this.calcSubTotal=function(){this.subTotalBill=0;for(var t=this.billArray.length-1;t>=0;t--)this.subTotalBill+=this.billArray[t].precio},this.calcAditional=function(){this.subTotalAditional=0;for(var t=this.aditionalArray.length-1;t>=0;t--)this.subTotalAditional+=this.aditionalArray[t].precio},this.getTaxes=function(){this.subTotalBill+=this.subTotalAditional;for(var t=this.taxesArray.length-1;t>=0;t--){var e=this.taxesArray[t].monto/100;this.taxesArray[t].taxAplay=this.subTotalBill*e}},this.calcTotal=function(){this.totalBill=0;for(var t=this.taxesArray.length-1;t>=0;t--)this.totalBill+=this.taxesArray[t].taxAplay;this.totalBill+=this.subTotalBillf}}),app.factory("secciontFactory",["$http","$httpParamSerializerJQLike",function(t){function e(e){t({method:"GET",url:a,cache:!0}).success(e)}var a=login_url;return{getModels:function(t,e){postSubmit(t,function(t){var a=t;get_JSON=t,e(a)})},getS1:function(t){e(function(e){var a=e.predeterminado;t(a)})},getS2:function(t){e(function(e){var a=e.escoger;t(a)})},getS3:function(t){e(function(e){var a=e.opcional;t(a)})},getS4:function(t){e(function(e){var a=e.arquitecto;t(a)})},getS5:function(t){e(function(e){var a=e.tax;t(a)})},get:function(e){return t.get(e)},save:function(e,a){return t({method:"GET",url:a,params:e,cache:!0})},destroy:function(e,a){return t["delete"](e+a)},setUrl:function(t){return a=t,console.log("url: "+a),!0}}}]),app.controller("generalCtrl",function(t,e,a){e.navArray=navArray,t.navArray=e.navArray,t.isLogIn=function(t){return e.isLogIn(t)},t.isActive=function(t){return e.isActive(t)},t.next=function(){e.next()},t.prev=function(){e.prev()},t.nextActive=function(){return e.nextActive()},t.prevActive=function(){return e.prevActive()},t.getSize=function(){var a=100;return 0!=e.count&&(a=100/(t.navArray.length-1)),a},t.$on("$routeChangeSuccess",function(t,a){0==e.count&&(location.href="#/")})}),app.controller("billCtrl",function(t,e,a){t.bill=a,t.billArray=a.billArray,t.aditionalArray=a.aditionalArray,t.arqSelect=a.arqSelect,t.hitch,t.meses,e.getS5(function(t){if(0==a.taxesActive){a.taxesArray=t;for(var e=a.taxesArray.length-1;e>=0;e--)a.taxesArray[e].taxAplay=0;a.taxesActive=!0,a.calcBill()}})}),app.controller("logInCtrl",function(t,e,a,i){t.deptos_url=deptos_url,t.login_url=login_url,t.models=[],a.get(deptos_url).success(function(e){for(var a=e,i=0;i<a.length;i++){var n=a[i].depto;t.models.push(n)}console.log(t.models)}),t.submit=function(t){if(t){e.userEmail=this.userEmail,e.deptoModel=this.userModel,e.deptoNumber=this.userDepto;var n={};n.modelo=this.userModel,n.acceso=this.userPassword,console.log(n),a.save(n,login_url).success(function(t){"invalido"!=t?e.next():i.swal("Error","Contraseña no valida","error")}).error(function(t){i.swal("Error de conexion","Revise su conexión a internet","error")})}else i.swal("Error","Capo invalido","error")}}),app.controller("baseCtrl",function(t,e,a,i){t.baseData=a.baseArray,e.getS1(function(e){if(0==a.baseArray.active){a.baseArray.seccion="Paquete Base",a.baseArray.elementos=[],t.rawData=e;for(var i in t.rawData){var n=t.rawData[i];n.disabled=!0,n.checked=!0,n.basePrice=0,n.section="Paquete Base",a.add(n),a.baseArray.elementos.push(n)}a.calcBill(),a.baseArray.active=!0}})}),app.controller("acabadosCtrl",function(t,e,a,i){t.sectionsData=a.acabadosArray,e.getS2(function(e){if(0==a.acabadosArray.active){t.rawData=e;for(var n in t.rawData){var o=t.rawData[n];for(var r in o.escogeroptions){var l=o.escogeroptions[r];l.checked=0==r?!0:!1,l.basePrice=0==r?0:l.precio-o.escogeroptions[0].precio,l.disabled=l.precio>=0?!1:!0,l.section=o.seccion,l.checked&&a.add(l)}o.selectedItem=0,a.acabadosArray.push(o),a.acabadosArray.active=!0}a.calcBill()}i.subCount.count=0,i.subCount.max=t.sectionsData.length,i.subCount.active=!0}),t.updateBill=function(t,e){var i=t.escogeroptions[t.selectedItem],n=t.escogeroptions.indexOf(e);i!=e?(i.checked=!1,a.delate(i),a.add(e),t.selectedItem=n,a.calcBill()):e.checked=!0},t.sectionActive=function(t){var e=i.subCount.count==t?!0:!1;return e},t.getTabSize=function(){var t=100/a.acabadosArray.length;return t}}),app.controller("addCtrl",function(t,e,a,i){t.sectionsData=a.adicionalesArray,e.getS3(function(e){if(0==a.adicionalesArray.active){t.rawData=e;for(var n in t.rawData){var o=t.rawData[n];for(var r in o.opcionaloptions){var l=o.opcionaloptions[r];l.checked=!1,l.disabled=!1,l.basePrice=l.precio,l.section=o.seccion}o.selectedItem=-1,a.adicionalesArray.push(o)}a.calcBill(),a.adicionalesArray.active=!0}i.subCount.count=0,i.subCount.max=t.sectionsData.length,i.subCount.active=!0}),t.updateBill=function(t,e){var i=t.opcionaloptions.indexOf(e);if(i==t.selectedItem){var n=t.opcionaloptions[t.selectedItem];n.checked=!1,a.delateAditional(n),t.selectedItem=-1}else{if(e.checked&&-1!=t.selectedItem){var n=t.opcionaloptions[t.selectedItem];n.checked=!1,a.delateAditional(n)}e.checked&&(a.addAditional(e),t.selectedItem=i)}a.calcBill()},t.sectionActive=function(t){var e=i.subCount.count==t?!0:!1;return e},t.getTabSize=function(){var t=100/a.adicionalesArray.length;return t}}),app.controller("arqCtrl",function(t,e,a){t.sectionsData=[],e.getS4(function(e){t.rawData=e;for(var a in t.rawData){var i=t.rawData[a];i.checked=!1,i.disabled=!1,t.sectionsData.push(i)}}),t.arqUpdate=function(t){t.checked?a.addArq(t):a.delateArq(t)}}),app.controller("sendCtrl",function(t,e,a){t.sendMail=function(){e.swal({title:"Enviado a: "+a.userEmail,text:"La cotizacion se envio con exito. ¿Desae cerrar terminar?",type:"success",showCancelButton:!0,confirmButtonColor:"#FF9500",confirmButtonText:"Terminar",cancelButtonColor:"#f3f3f3",cancelButtonText:"Continuar",closeOnConfirm:!1},function(){e.swal("Booyah!")})}}),app.filter("priceFilter",function(){return function(t){return t>0?"+ $"+t:0==t?"Incluido":0>t?"Consulte al Probedor":void 0}});